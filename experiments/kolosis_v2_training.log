Using device: cuda
Sample dataset created in data/tinystories
JSON: data/tinystories/sample.json
TOON: data/tinystories/sample.toon

File size comparison:
JSON: 302 bytes
TOON: 280 bytes
TOON is 7.3% smaller
Loaded 4 stories
Vocab size: 29
Train samples: 3, Val samples: 1
Model parameters: 454,110

============================================================
PHASE 1: Pre-training Streams Independently
============================================================
Epoch   0 | Train: 3.3662 | Val: 3.2699
Epoch   5 | Train: 3.1579 | Val: 2.9701
Epoch  10 | Train: 3.0613 | Val: 2.7738
Epoch  15 | Train: 2.9376 | Val: 2.7489
Phase 1 complete! Final val loss: 2.8510

============================================================
PHASE 2: Training Fusion Gates
============================================================
Epoch   0 | Train: 2.8472 | Val: 2.8477 | Gates: [0.24511467 0.2590875  0.24172565 0.25407222]
Epoch   5 | Train: 2.8570 | Val: 2.8316 | Gates: [0.2288571  0.27166644 0.22063696 0.2788395 ]
Epoch  10 | Train: 2.8274 | Val: 2.8166 | Gates: [0.21108556 0.28230697 0.19789883 0.30870867]
Epoch  15 | Train: 2.7842 | Val: 2.8017 | Gates: [0.18804729 0.290497   0.17312348 0.34833235]
Epoch  20 | Train: 2.7847 | Val: 2.7868 | Gates: [0.15772843 0.29875797 0.14491412 0.39859948]
Epoch  25 | Train: 2.7495 | Val: 2.7675 | Gates: [0.12528741 0.29139054 0.11524373 0.46807832]
Phase 2 complete! Final val loss: 2.7475

============================================================
PHASE 3: End-to-End Fine-tuning
============================================================
Epoch   0 | Train: 2.7674 | Val: 2.7443
Epoch  10 | Train: 2.6591 | Val: 2.6962
Epoch  20 | Train: 2.6097 | Val: 2.6641
Epoch  30 | Train: 2.5883 | Val: 2.6324
Epoch  40 | Train: 2.5134 | Val: 2.6133
Phase 3 complete! Best val loss: 2.5633

============================================================
TRAINING COMPLETE
============================================================
Total time: 20.6s
Final val loss: 2.5633
Results saved to experiments/kolosis_v2_results/training_results.json
